// Backup Atom packages
task backupAtomPackages {

  doLast {
    def output = new ByteArrayOutputStream()
    exec {
      workingDir "/usr/bin"
      executable 'apm'
      args 'list', '--installed', '--bare'
      standardOutput = output
    }

    File packages = new File("${projectDir}/ansible/files/atom-packages.list")
    packages.write output.toString().trim()
  }

}

task installBackupFileToAtom {

  doLast {
    exec {
      workingDir "/usr/bin"
      executable 'apm'
      args 'install', '--packages-file', "${projectDir}/ansible/files/atom-packages.list"
    }
  }
}
